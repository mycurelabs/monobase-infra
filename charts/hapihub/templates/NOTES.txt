{{- if .Values.enabled }}
ğŸ‰ Monobase API has been deployed!

Chart: {{ .Chart.Name }}-{{ .Chart.Version }}
Release: {{ .Release.Name }}
Namespace: {{ include "api.namespace" . }}

ğŸ“‹ Deployment Information:
  - Replicas: {{ .Values.replicaCount }}
  - Image: {{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}
  - Service: {{ include "api.fullname" . }}:{{ .Values.service.port }}

ğŸŒ Access Information:
{{- if .Values.gateway.enabled }}
  Monobase API: https://{{ include "api.gateway.hostname" . }}

  Test the API:
  curl https://{{ include "api.gateway.hostname" . }}/health
{{- else }}
  Gateway is disabled. Use port-forward to access:
  kubectl port-forward -n {{ include "api.namespace" . }} svc/{{ include "api.fullname" . }} {{ .Values.service.port }}:{{ .Values.service.port }}
{{- end }}

ğŸ“Š Monitoring:
{{- if .Values.serviceMonitor.enabled }}
  âœ… ServiceMonitor enabled - Metrics available at /metrics
{{- else }}
  âš ï¸  ServiceMonitor disabled - Enable for production monitoring
{{- end }}

ğŸ” Secrets:
{{- if .Values.externalSecrets.enabled }}
  âœ… External Secrets enabled - Syncing from {{ .Values.externalSecrets.secretStore | default (printf "%s-secretstore" (include "api.namespace" .)) }}
{{- else }}
  âš ï¸  External Secrets disabled - Ensure secrets are manually created
{{- end }}

ğŸ“ˆ Autoscaling:
{{- if .Values.autoscaling.enabled }}
  âœ… HPA enabled - {{ .Values.autoscaling.minReplicas }}-{{ .Values.autoscaling.maxReplicas }} replicas
{{- else }}
  â„¹ï¸  HPA disabled - Fixed {{ .Values.replicaCount }} replicas
{{- end }}

ğŸ›¡ï¸  Security:
{{- if .Values.networkPolicy.enabled }}
  âœ… NetworkPolicy enabled
{{- else }}
  âš ï¸  NetworkPolicy disabled - Enable for production
{{- end }}
{{- if .Values.podDisruptionBudget.enabled }}
  âœ… PodDisruptionBudget enabled (minAvailable: {{ .Values.podDisruptionBudget.minAvailable }})
{{- else }}
  âš ï¸  PodDisruptionBudget disabled - Enable for HA
{{- end }}

ğŸ” Next Steps:
  1. Verify pods are running:
     kubectl get pods -n {{ include "api.namespace" . }} -l app.kubernetes.io/name={{ include "api.name" . }}

  2. Check logs:
     kubectl logs -n {{ include "api.namespace" . }} -l app.kubernetes.io/name={{ include "api.name" . }} --tail=50

  3. Verify HTTPRoute:
     kubectl get httproute -n {{ include "api.namespace" . }}

  4. Test health endpoint:
     curl https://{{ include "api.gateway.hostname" . }}/health

ğŸ“š Documentation:
  - Values Reference: docs/VALUES-REFERENCE.md
  - Deployment Guide: docs/DEPLOYMENT.md
  - Architecture: docs/ARCHITECTURE.md

{{- else }}
HapiHub is disabled (enabled: false)
{{- end }}
