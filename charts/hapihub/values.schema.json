{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "HapiHub Helm Chart Values",
  "description": "Configuration values for HapiHub healthcare API deployment",
  "type": "object",
  "properties": {
    "global": {
      "type": "object",
      "description": "Global configuration shared across all charts",
      "required": ["domain", "namespace", "environment"],
      "properties": {
        "domain": {"type": "string", "pattern": "^[a-z0-9.-]+\\.[a-z]{2,}$"},
        "namespace": {"type": "string", "pattern": "^[a-z0-9-]+$"},
        "environment": {"type": "string", "enum": ["development", "staging", "production"]},
        "gateway": {
          "type": "object",
          "required": ["name", "namespace"],
          "properties": {
            "name": {"type": "string"},
            "namespace": {"type": "string"}
          }
        }
      }
    },
    "enabled": {"type": "boolean", "default": true},
    "replicaCount": {"type": "integer", "minimum": 1, "default": 2},
    "image": {
      "type": "object",
      "required": ["repository", "tag"],
      "properties": {
        "repository": {"type": "string"},
        "tag": {"type": "string", "pattern": "^([0-9]+\\.[0-9]+\\.[0-9]+|latest)$"},
        "pullPolicy": {"type": "string", "enum": ["Always", "IfNotPresent", "Never"], "default": "IfNotPresent"}
      }
    },
    "resources": {
      "type": "object",
      "properties": {
        "requests": {
          "type": "object",
          "properties": {
            "cpu": {"type": "string", "pattern": "^[0-9]+m?$"},
            "memory": {"type": "string", "pattern": "^[0-9]+[MGT]i$"}
          }
        },
        "limits": {
          "type": "object",
          "properties": {
            "cpu": {"type": "string"},
            "memory": {"type": "string"}
          }
        }
      }
    },
    "autoscaling": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean", "default": false},
        "minReplicas": {"type": "integer", "minimum": 1},
        "maxReplicas": {"type": "integer", "minimum": 1},
        "targetCPUUtilizationPercentage": {"type": "integer", "minimum": 1, "maximum": 100},
        "targetMemoryUtilizationPercentage": {"type": "integer", "minimum": 1, "maximum": 100}
      }
    },
    "gateway": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean", "default": true},
        "hostname": {"type": "string"}
      }
    },
    "networkPolicy": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean", "default": true}
      }
    },
    "podDisruptionBudget": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean", "default": true},
        "minAvailable": {"type": "integer", "minimum": 1}
      }
    },
    "externalSecrets": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean", "default": true},
        "secretStore": {"type": "string"},
        "refreshInterval": {"type": "string", "default": "1h"}
      }
    },
    "mongodb": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean", "default": true},
        "replicaCount": {"type": "integer", "minimum": 1, "default": 3},
        "persistence": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean", "default": true},
            "size": {"type": "string", "pattern": "^[0-9]+Gi$"}
          }
        }
      }
    }
  },
  "required": ["global", "enabled"]
}
